# Benchmark Results Log

## Phase: std::span Refactor (Baseline)

This phase establishes the baseline performance after refactoring core interfaces to use `std::span`. Future optimizations will be compared against these metrics.

### Consolidated Results

| Run Timestamp | Test Name | Iterations | Payload Size | Avg Latency (ms) | P50 (ms) | P99 (ms) | Packets/s | MB/s |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 2026-01-28 07:46:00 | LatencyTest | 10000 | 64 | 0.0526 | 0.0345 | 0.1064 | 19008.17 | 1.16 |
| 2026-01-28 07:52:41 | LatencyTest | 10000 | 64 | 0.0629 | 0.0343 | 0.2306 | 15890.02 | 0.97 |
| 2026-01-28 07:52:43 | LatencyTest | 10000 | 64 | 0.0665 | 0.0344 | 0.1160 | 15046.14 | 0.92 |
| 2026-01-28 07:52:49 | LatencyTest | 9999 | 64 | 0.0662 | 0.0339 | 0.2464 | 15112.31 | 0.92 |
| 2026-01-28 07:52:56 | LatencyTest | 10000 | 64 | 0.0622 | 0.0343 | 0.1668 | 16077.21 | 0.98 |
| 2026-01-28 07:53:04 | LatencyTest | 9999 | 64 | 0.0491 | 0.0318 | 0.0926 | 20383.81 | 1.24 |
| 2026-01-28 07:53:09 | LatencyTest | 10000 | 64 | 0.0677 | 0.0341 | 0.0942 | 14779.27 | 0.90 |
| 2026-01-28 07:53:12 | LatencyTest | 10000 | 64 | 0.0680 | 0.0343 | 0.1381 | 14709.99 | 0.90 |

---

### π“ 1. ν„μ¬ λ²¤μΉλ§ν¬ κ²°κ³Ό λ¶„μ„ (Baseline Analysis)

ν„μ¬ **`std::span` λ¦¬ν©ν† λ§ μ§ν›„μ λ² μ΄μ¤λΌμΈ** μ„±λ¥μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

*   **P50 (μ¤‘μ•™κ°’) Latency**: μ•½ **0.034ms (34Βµs)**
    *   κΈ°λ³Έμ μΈ I/O μ²λ¦¬ μ†λ„λ” λ§¤μ° λΉ λ¦…λ‹λ‹¤. IOCP κµ¬μ΅° μμ²΄λ” ν¨μ¨μ μΌλ΅ μ‘λ™ν•κ³  μμμ„ λ³΄μ—¬μ¤λ‹λ‹¤.
*   **Avg (ν‰κ· ) Latency**: μ•½ **0.05ms ~ 0.06ms (50~60Βµs)**
    *   P50 λ€λΉ„ ν‰κ· μ΄ μ•½ 2λ°° κ°€κΉμ΄ λ†’μµλ‹λ‹¤. **μ΄λ” μΌλ¶€ ν¨ν‚· μ²λ¦¬κ°€ μ§€μ—°**λκ³  μμμ„ μλ―Έν•©λ‹λ‹¤.
*   **P99 (μƒμ„ 1%) Latency**: **0.09ms ~ 0.24ms (90~240Βµs)**
    *   μƒμ„ 1%μ ν¨ν‚·μ—μ„ μ§€μ—° μ‹κ°„μ΄ κΈ‰κ²©ν λμ–΄λ‚©λ‹λ‹¤ (P50μ 3~7λ°°). κ°„ν—μ μΈ **Jitter(ν€λ” ν„μƒ)** μ΄ λ°μƒν•κ³  μμµλ‹λ‹¤.
*   **Throughput (μ²λ¦¬λ‰)**: **μ•½ 14,000 ~ 20,000 PPS** (μ΄λ‹Ή ν¨ν‚· μ)
    *   ν„μ¬ λ΅μ§μΌλ΅λ” μ΄λ‹Ή μ•½ 1.5λ§~2λ§ κ±΄ μ •λ„λ¥Ό μ²λ¦¬ν•  μ μλ” μμ¤€μ…λ‹λ‹¤.

### π€ 2. μµμ ν™” μ°μ„ μμ„ λ° μ „λµ

ν„μ¬ λ°μ΄ν„°μ—μ„ **P99 Latencyκ°€ λ¶μ•μ •ν• κ²ƒ**κ³Ό **μ²λ¦¬λ‰(PPS)** μ„ κ°μ„ ν•κΈ° μ„ν•΄ λ‹¤μ μμ„λ΅ μµμ ν™”λ¥Ό μ§„ν–‰ν•λ” κ²ƒμ„ μ¶”μ²ν•©λ‹λ‹¤.

#### **1μμ„: λ©”λ¨λ¦¬ ν• λ‹Ή μµμ†ν™” (Memory Allocation Optimization)**
*   **μ§„λ‹¨**: κ°€μ¥ μ λ ¥ν• λ³‘λ© μ›μΈμ…λ‹λ‹¤. ν¨ν‚·μ„ μμ‹ /μ†΅μ‹ ν•  λ•λ§λ‹¤ `new/delete`λ¥Ό ν•κ±°λ‚ `std::vector` μ¬ν• λ‹Ήμ΄ λ°μƒν•λ©΄ ν™ λ½(Heap Lock)κ³Ό λ©”λ¨λ¦¬ ννΈν™”λ΅ μΈν•΄ μ„±λ¥μ΄ λ“¤μ­‰λ‚ μ­‰ν•΄μ§‘λ‹λ‹¤.
*   **μ•΅μ…**: **Object Pool (λ©”λ¨λ¦¬ ν’€)** λ„μ….
    *   `Packet` κ°μ²΄λ‚ λ²„νΌλ¥Ό λ―Έλ¦¬ ν• λ‹Ήν•΄λ‘κ³  μ¬μ‚¬μ©ν•λ„λ΅ λ³€κ²½ν•©λ‹λ‹¤.
*   **μμƒ ν¨κ³Ό**:
    *   **P99 Latency λ€ν­ κ°μ†** (Jitter μ κ±°).
    *   Throughput **2λ°° μ΄μƒ μ¦κ°€** μμƒ.

#### **2μμ„: λ°μ΄ν„° λ³µμ‚¬ μ¤„μ΄κΈ° (Zero-Copy with std::span)**
*   **μ§„λ‹¨**: `std::span`μ„ λ„μ…ν–μΌλ‚, μ‹¤μ  λ΅μ§ λ‚΄λ¶€μ—μ„ μ—¬μ „ν λ¶ν•„μ”ν• `memcpy`κ°€ μΌμ–΄λ‚λ”μ§€ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤.
*   **μ•΅μ…**: λ²„νΌμ—μ„ λ°μ΄ν„°λ¥Ό κΊΌλ‚Ό λ• λ³µμ‚¬ν•΄μ„ μƒλ΅μ΄ κ°μ²΄λ¥Ό λ§λ“λ” λ€μ‹ , `span`μ„ ν†µν•΄ μ›λ³Έ λ²„νΌλ¥Ό κ·Έλ€λ΅ μ½λ„λ΅ ν¨ν‚· νμ‹± λ΅μ§μ„ μ κ²€ν•©λ‹λ‹¤.
*   **μμƒ ν¨κ³Ό**: CPU μ‚¬μ©λ‰ κ°μ† λ° μ²λ¦¬λ‰(PPS) μ¦κ°€.

#### **3μμ„: λ™κΈ°ν™” κ°μ²΄ μ κ²€ (Lock Contention)**
*   **μ§„λ‹¨**: `CircleBufferQueue`λ‚ λ΅κΉ… μ‹μ¤ν…μ—μ„ Lock κ²½ν•©μ΄ λ°μƒν•  μ μμµλ‹λ‹¤.
*   **μ•΅μ…**:
    *   Lock λ²”μ„λ¥Ό μµμ†ν™”ν•κ±°λ‚, Lock-free μλ£κµ¬μ΅° κ²€ν† .
    *   λ²¤μΉλ§ν¬ μ¤‘μ—λ” Console Loggingμ„ μµμ†ν™” (λΉ„λ™κΈ° λ΅κ±° μ‚¬μ© λ“±).
*   **μμƒ ν¨κ³Ό**: μ¤λ λ“ κ²½ν•©μΌλ΅ μΈν• κ°„ν—μ  λ©μ¶¤ ν„μƒ(Max Latency) μ κ±°.

#### **4μμ„: λ„¤νΈμ›ν¬ μµμ… ν™•μΈ (Nagle's Algorithm)**
*   **μ•΅μ…**: μ†μΌ“ μµμ…μ—μ„ `TCP_NODELAY`κ°€ μΌμ Έ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤. (λ―Έμ„¤μ • μ‹ μ‘μ€ ν¨ν‚·μ„ λ¨μ•„μ„ λ³΄λ‚΄λλΌ μ§€μ—° λ°μƒ)
*   **μμƒ ν¨κ³Ό**: Latencyμ κΈ°λ³Έκ°’(P50) μμ²΄κ°€ λ” μ¤„μ–΄λ“¤ μ μμ.

### π’΅ μ”μ•½
ν„μ¬ **34Βµs(P50)**λΌλ” ν›λ¥­ν• μ μ¬λ ¥μ„ κ°€μ§€κ³  μμµλ‹λ‹¤. **λ©”λ¨λ¦¬ ν’€λ§(Object Pooling)**μ„ μµμ°μ„ μΌλ΅ μ μ©ν•λ©΄ **200Βµs μ΄μƒ ν€λ” ν¨ν‚·(P99)**λ“¤μ„ μ΅κ³  μ²λ¦¬λ‰μ„ νκΈ°μ μΌλ΅ λλ¦΄ μ μμ„ κ²ƒμ…λ‹λ‹¤.

